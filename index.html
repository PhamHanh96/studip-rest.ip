---
---
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Stud.IP: Rest.IP API Dokumentation</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body id="top">
    <div class="wrapper">
        <a href="https://github.com/studip/studip-rest.ip"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>
      <header>

        <h1>Stud.IP: Rest.IP</h1>
        <p>Ein alternativer, "RESTful" Ansatz für Webservices basierend auf OAuth</p>
        <h2><a href="#top">API Dokumentation</a></h2>
        <dl>
            <dt><a href="#oauth">/oauth</a></dt>
            <dd><a href="#oauth">Autorisierung</a></dd>
            <dt><a href="#api-discovery">/api/discovery</a></dt>
            <dd><a href="#api-discovery">Informationen über die API</a></dd>
            <dt><a href="#api-courses">/api/courses</a></dt>
            <dd><a href="#api-courses">Veranstaltungen</a></dd>
            <dt><a href="#api-documents">/api/documents</a></dt>
            <dd><a href="#api-documents">Dateien</a></dd>
            <dt><a href="#api-message">/api/message</a></dt>
            <dd><a href="#api-message">Nachrichten</a></dd>
            <dt><a href="#api-news">/api/news</a></dt>
            <dd><a href="#api-news">Ankündigungen</a></dd>
            <dt><a href="#api-semesters">/api/semesters</a></dt>
            <dd><a href="#api-semesters">Semester</a></dd>
            <dt><a href="#api-studip">/api/studip</a></dt>
            <dd><a href="#api-studip">Globale Einstellungen</a></dd>
            <dt><a href="#api-user">/api/user</a></dt>
            <dd><a href="#api-user">Nutzer</a></dd>
        </dl>
        <h2><a href="#api-activities">Bekannte Plugin-Routes</a></h2>
        <dl>
            <dt><a href="#api-activities">/api/activities</a></dt>
            <dd><a href="#api-activities">Aktivitäten</a></dd>
        </dl>
      </header>
      <section>
        <h3>Rest.IP</h3>

        <h3>API-Dokumentation</h3>
        <h4>Allgemeines</h4>
        <p>
            Bei jedem Request sendet die API den HTTP-Header <strong>X-Server-Timestamp</strong>
            ihren aktuellen Unix-Zeitstempel mit.
        </p>
        <p class="attention">
            Zu beachten ist, dass bei sämtlichen Nutzerrückgabe auch der Nutzer mit der Id
            <code>____%system%____</code> vorkommen kann. Dies sind system-interne Vorgänge
            bzw. Benachrichtigungen und sollten als diese gekennzeichnet werden.
        </p>

        <h4>Autorisierung</h4>
        <p>
            Die Autorisierung erfolgt mittels sogenanntem <strong>3-legged OAuth</strong>. Im
            Gegensatz zum <em>2-legged OAuth</em>, bei dem sich nur die Applikation
            beim Server autorisiert, ist beim <em>3-legged OAuth</em> zusätzlich eine
            Autorisierung des zugreifenden Nutzers erforderlich.
        </p>
        <p>
            Die Autorisierung des Nutzers erfolgt dabei vollkommen transparent, da die
            Autorisierung auf Seiten des autorisierenden Servers erfolgt. Die zur
            Autorisierung erforderlichen Nutzerdaten verlassen somit niemals das System.
        </p>
        <p>
            Der komplette Workflow von OAuth findest sich unter
            <a href="http://oauth.net/core/diagram.png">http://oauth.net/core/diagram.png</a>.
        <p>
            Weitere Details zu OAuth finden sie auf <a href="http://oauth.net">http://oauth.net</a>.
            Informationen zur Autorisierung dieser API finden Sie in der Dokumentation unter
            <a href="#oauth">/oauth</a>.
        </p>
        
        <h4>Aufbau der Rückgabe</h4>
        <p>
            Die API unterscheidet <ins>zukünftig</ins> zwei verschiedene Modi, die den Aufbau der Rückgabe steuern:
        </p>
        <ul>
            <li>
                <h5>"compact"</h5>
                Die Rückgabe enthält lediglich die angeforderten Ressourcen des angeforderten Typs.
                Anhängige Ressourcen anderen Typs sind durch ihre eindeutige Id vermerkt.
            </li>
            <li>
                <h5>"complete" <small>(Standard)</small></h5>
                Die Rückgabe enthält die angeforderten Ressourcen des angeforderten Typs und
                zusätzlich auch die eventuell anhängigen Ressourcen eines oder mehreren anderen
                Typs.<br>
                Zur Verdeutlichung: Veranstaltungsdaten enthalten zusätzlich auch die vollständigen
                Nutzerdaten der Lehrenden und Teilnehmer sowie die vollständigen Semesterdaten der
                verbundenen Semester.
            </li>
        </ul>
        <p>
            <strong>Bitte beachten:</strong> Obwohl <code>complete</code> der Standardwert ist, bezieht
            sich diese Dokumentation in ihren Beispiel aus offensichtlichen Gründen auf den Modus
            <code>compact</code>.
        </p>

        <h4>Rückgabeformate</h4>
        <p>
            Die Rückgabe kann entweder im <strong>JSON</strong>- oder <strong>XML</strong>-Format erfolgen.
            Das jeweilige Format wird durch die Dateiendung der angeforderten Ressource
            bestimmt. Ein Zugriff auf <code>/api/news.json</code> liefert die Ankündigungen
            eines Nutzers im JSON-Format zurück, während <code>/api/news.xml</code>
            die Ankündigungen im XML-Format zurückgeben würde.
        </p>

        <h3>Die Routen im Detail</h3>
        <h4 id="oauth">/oauth - Autorisierung</h4>
        <p>
            Die 3 Endpunkte der Autorisierung sind die folgenden:
        </p>
        <ol>
            <li>
                <h5>/oauth/request_token</h5>
                Fragt einen temporären, unautorisierten Token beim Server ab.
            </li>
            <li>
                <h5>/oauth/authorize</h5>
                In diesem Schritt wird dem Benutzer ein Dialog angezeigt, in dem
                er zustimmen muss, den Token aus Schritt zu autorisieren.
            </li>
            <li>
                <h5>/oauth/access_token</h5>
                Holt ein dauerhaftes, autorisiertes Token im Austausch gegen das
                in Schritt autorierte Token.
            </li>
        </ol>
        <p>
            Für die Autorisierung werden weiterhin die beiden Schlüssel
            <code>consumer_key</code> und <code>consumer_secret</code>
            benötigt, welche vom Betreiber der jeweiligen Stud.IP-Instanz
            vergeben werden.
        </p>

        <h4 id="api-discovery">/api/discovery - Informationen über die API</h4>
        <h5>GET</h5>
        <p>
            Liefert Informationen über die in der Instanz unterstützten Routen,
            ihrer Methoden und den jeweiligen Zugriffsberechtigungen zurück.
        </p>
        <pre type="application/json">{% include discovery.json %}</pre>
        <p>
            In dem obigen Beispiel sind alle Routen erlaubt bis auf <code>/api/courses</code>,
            also der Zugriff auf die Veranstaltungen.
        </p>
        <p class="todo">
            Routen nutzen sich untereinander, um Informationen abzurufen. Ist der Zugriff
            auf ein davon untersagt, schlägt die gesamte Anfrage fehl.
        </p>

        <h4 id="api-courses">/api/courses - Belegte Veranstaltungen</h4>
        <h5>GET</h5>
        <p>
            Liefert die Veranstaltungen zurück, in die der Nutzer eingetragen ist.
        </p>
        <pre type="application/json">{% include courses.json %}</pre>

        <h4>/api/courses/<em>:course_id</em> - Daten einer Veranstaltung</h4>
        <h5>GET</h5>
        <p>
            Liefert die Daten der übergebenen Veranstaltung zurück.
        </p>
        <pre type="application/json">{% include courses-course_id.json %}</pre>
        
        <h4>/api/courses/semester - Belegte Semester</h4>
        <h5>GET</h5>
        <p>
            Liefert alle Semester zurück, in denen der Nutzer in mindestens eine
            Veranstaltung eingetragen ist. 
        </p>
        <pre type="application/json">{% include courses-semester.json %}</pre>

        <h4>/api/courses/semester/<em>:semester_id</em> - Belegte Veranstaltungen eines Semesters</h4>
        <h5>GET</h5>
        <p>
            Liefert die Veranstaltungen zurück, in die der Nutzer in dem angegebenen
            Semester eingetragen ist.
        </p>
        <pre type="application/json">{% include courses-semester-semester_id.json %}</pre>

        <h4 id="api-documents">/api/documents/<em>:document_id</em> - Daten eines Dokuments</h4>
        <h5>GET</h5>
        <p>
            Liefert die Daten eines Dokuments zurück.
        </p>
        <pre type="application/json">{% include documents-document_id.json %}</pre>

        <h4>/api/documents/<em>:document_id</em>/download - Download eines Dokuments</h4>
        <h5>GET</h5>
        <p>
            Liefert das Dokument als solches zurück.
        </p>
        <p>- kein Beispiel -</p>
        
        <h4>/api/documents/<em>:range_id</em>/folder/&lt;<em>:folder_id</em>&gt; - Dateien eines Ordners</h4>
        <h5>GET</h5>
        <p>
            Liefert die Dateien und Ordner eines übergebenen Ordners einer Veranstaltung zurück.
        </p>
        <pre type="application/json">{% include documents-range_id-folder.json %}</pre>

        <h4 id="api-message">/api/messages/<em>:box</em> - Nachrichtenordner auslesen</h4>
        <h5>GET</h5>
        <p>
            Liefert die vorhandenen Nachrichtenordner des autorisierten Nutzers zurück. Der Parameter
            bestimmt je nach Wert, auf welchen Bereich zugegriffen werden soll:
        </p>
        <ul>
            <li><h5>in</h5>Nachrichteneingang</li>
            <li><h5>out</h5>Nachrichtenausgang</li>
        </ul>
        <pre type="application/json">{% include messages-box.json %}</pre>

        <h4 id="api-message">/api/messages/<em>:message_id</em> - Daten einer Nachricht</h4>
        <h5>GET</h5>
        <p>
            Liefert die Daten der übergebenen Nachricht zurück.
        </p>
        <pre type="application/json">{% include messages-message_id.json %}</pre>

        <h5>DELETE</h5>
        <p>
            Löscht die übergebene Nachricht.
        </p>
        <p>
            HTTP-Status der Rückgabe:
        </p>
        <ul>
            <li><code>204</code> bei Erfolg</li>
            <li><code>403</code> wenn die Nachricht nicht gelöscht werden darf</li>
            <li><code>404</code> wenn die Nachricht nicht gefunden wurde</li>
        </ul>

        <h4 id="api-message">/api/messages/<em>:box</em>/<em>:folder</em> - Nachrichten eines Ordners auslesen</h4>
        <h5>GET</h5>
        <p>
            Liefert die vorhandenen Nachrichten eines Ordners des autorisierten Nutzers
            zurück.
        </p>
        <pre type="application/json">{% include messages-box-folder.json %}</pre>

        <h4 id="api-news">/api/news - Ankündigungen des Nutzers</h4>
        <p>
            Liefert die Ankündigungen des autorisierten Nutzers zurück.
        </p>
        <pre type="application/json">{% include news.json %}</pre>
        
        <h4>/api/news/<em>:news_id</em> - Daten einer Ankündigung</h4>
        <p>
            Liefert die Daten der übergebenen Ankündigung zurück.
        </p>
        <pre type="application/json">{% include news-news_id.json %}</pre>

        <h4>/api/news/range/<em>:range_id</em> - Ankündigungen einer <em>Range</em></h4>
        <p>
            Liefert die Ankündigungen der übergebenen <em>Range</em> zurück. Eine <em>Range</em>
            kann hierbei die Id eines Nutzers, einer Veranstaltung/Studiengruppe, eines Instituts
            oder <code>studip</code> für globale Ankündigungen sein.
        </p>
        <pre type="application/json">{% include news-news_id.json %}</pre>

        <h4 id="api-semesters">/api/semesters - Alle Semester</h4>
        <p>
            Liefert alle bekannten Semester der Installation zurück.
        </p>
        <pre type="application/json">{% include semesters.json %}</pre>

        <h4 id="api-semesters">/api/semesters/<em>:semester_id</em> - Daten eines Semesters</h4>
        <p>
            Liefert die Daten des übergebenen Semesters zurück.
        </p>
        <pre type="application/json">{% include semesters-semester_id.json %}</pre>

        <h4 id="api-studip">/api/studip/settings - Globale Einstellungen</h4>
        <p>
            Liefert lokale Einstellungswerte Stud.IP-interner Konfigurationen
            zurück.<br>
            Diese Werte dienen dazu, die Daten verschiedener Ressourcen an
            den Standort angepasst interpretieren zu können.
        </p>
        <pre type="application/json">{% include studip-settings.json %}</pre>

        <h4 id="api-courses">/api/user/&lt;<em>:user_id</em>&gt; - Nutzerdaten</h4>
        <h5>GET</h5>
        <p>
            Liefert die Daten des Nutzers mit der übergebenen Id zurück. Ist keine Id
            angegeben, so werden die Daten des autorisierten Nutzers zurückgegeben.
        </p>
        <pre type="application/json">{% include user.json %}</pre>

        <h4 id="api-activities">/api/activities - Aktivitäten</h4>
        <p>
            Liefert die Aktivitäten im Umfeld des autorisierten Nutzers zurück.
        </p>
        <pre type="application/json">{% include activities.json %}</pre>
        <p class="todo">
            Diese Route wurde versuchsweise in das
            <a href="http://plugin-dev.studip.de/index.php/Plugins/00062">ActivityFeed</a>-Plugin
            von Elmar Ludwig eingebaut und ist noch experimentell.
        </p>
        
      </section>
      <footer>
        <p><a href="https://github.com/studip/studip-rest.ip">This project</a> is maintained by <a href="https://github.com/studip">studip</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
    <script src="javascripts/litelighter/jquery-litelighter.js"></script>
    <script src="javascripts/script.js"></script>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>